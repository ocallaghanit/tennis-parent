<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Comparison - Tennis Data Adapter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Space Grotesk', sans-serif; }
        .mono { font-family: 'SF Mono', 'Fira Code', monospace; }
        select { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e"); background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em; }
    </style>
</head>
<body class="bg-slate-950 text-slate-100 min-h-screen">
    <!-- Navigation -->
    <header class="border-b border-slate-800 bg-slate-900/50 backdrop-blur sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <span class="text-2xl">üéæ</span>
                <h1 class="text-xl font-bold text-emerald-400">Tennis Data Adapter</h1>
            </div>
            <nav class="flex gap-6 text-sm">
                <a href="/ui/dashboard" class="text-slate-400 hover:text-emerald-400 transition-colors">Dashboard</a>
                <a href="/ui/fixtures" class="text-slate-400 hover:text-emerald-400 transition-colors">Fixtures</a>
                <a href="/ui/tournaments" class="text-slate-400 hover:text-emerald-400 transition-colors">Tournaments</a>
                <a href="/ui/players" class="text-slate-400 hover:text-emerald-400 transition-colors">Players</a>
                <a href="/ui/compare" class="text-emerald-400">Compare</a>
                <a href="/ui/sync" class="text-slate-400 hover:text-emerald-400 transition-colors">Sync</a>
                <a href="/swagger-ui.html" class="text-slate-500 hover:text-slate-300 transition-colors">API Docs ‚Üí</a>
            </nav>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-8">
        <!-- Page Title -->
        <div class="mb-8">
            <h2 class="text-3xl font-bold text-white mb-2">‚öîÔ∏è Player Comparison</h2>
            <p class="text-slate-400">Select two players to compare their head-to-head record and statistics</p>
        </div>

        <!-- Player Selection Form -->
        <form method="get" action="/ui/compare" class="bg-slate-900/50 border border-slate-800 rounded-xl p-6 mb-8">
            <div class="grid md:grid-cols-2 gap-6 items-end">
                <!-- Player 1 -->
                <div>
                    <label class="block text-slate-400 text-sm mb-2">Player 1</label>
                    <select name="player1" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 pr-10 text-white focus:border-emerald-500 focus:outline-none appearance-none">
                        <option value="">Select Player 1</option>
                        <option th:each="p : ${allPlayers}" 
                                th:value="${p.playerKey}" 
                                th:text="${p.playerName + (p.currentRank != null ? ' (#' + p.currentRank + ')' : '') + (p.country != null ? ' - ' + p.country : '')}"
                                th:selected="${p.playerKey == player1Key}">Player Name</option>
                    </select>
                </div>
                
                <!-- Player 2 -->
                <div>
                    <label class="block text-slate-400 text-sm mb-2">Player 2</label>
                    <select name="player2" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 pr-10 text-white focus:border-emerald-500 focus:outline-none appearance-none">
                        <option value="">Select Player 2</option>
                        <option th:each="p : ${allPlayers}" 
                                th:value="${p.playerKey}" 
                                th:text="${p.playerName + (p.currentRank != null ? ' (#' + p.currentRank + ')' : '') + (p.country != null ? ' - ' + p.country : '')}"
                                th:selected="${p.playerKey == player2Key}">Player Name</option>
                    </select>
                </div>
            </div>
            <div class="mt-4 flex justify-center">
                <button type="submit" class="px-8 py-3 bg-emerald-600 hover:bg-emerald-500 text-white font-semibold rounded-lg transition-colors">
                    ‚öîÔ∏è Compare Players
                </button>
            </div>
        </form>

        <!-- Comparison Results -->
        <div th:if="${player1 != null && player2 != null}">
            
            <!-- Player Cards Side by Side -->
            <div class="grid md:grid-cols-2 gap-6 mb-8">
                <!-- Player 1 Card -->
                <div class="bg-gradient-to-br from-blue-900/30 to-slate-800 border border-blue-800/50 rounded-xl p-6">
                    <div class="flex items-center gap-4 mb-4">
                        <div class="flex-shrink-0">
                            <img th:if="${player1Image}" th:src="${player1Image}" 
                                 alt="Player 1" class="w-20 h-20 rounded-full object-cover border-3 border-blue-400"
                                 onerror="this.style.display='none'">
                            <div th:unless="${player1Image}" 
                                 class="w-20 h-20 rounded-full bg-slate-700 flex items-center justify-center text-3xl border-3 border-blue-400">
                                üë§
                            </div>
                        </div>
                        <div>
                            <a th:href="@{/ui/player/{key}(key=${player1.playerKey})}" 
                               class="text-2xl font-bold text-blue-400 hover:text-blue-300 transition-colors"
                               th:text="${player1.playerName}">Player 1</a>
                            <div class="text-slate-400">
                                <span th:text="${player1.country}">Country</span>
                                <span th:if="${player1.currentRank}" class="ml-2">‚Ä¢ Rank #<span th:text="${player1.currentRank}">1</span></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Form -->
                    <div class="border-t border-slate-700 pt-4">
                        <div class="text-sm text-slate-400 mb-2">Recent Form (Last 10)</div>
                        <div class="flex items-center gap-2">
                            <span class="text-emerald-400 font-bold" th:text="${p1RecentWins}">0</span>
                            <span class="text-slate-500">W</span>
                            <span class="text-slate-600 mx-1">-</span>
                            <span class="text-red-400 font-bold" th:text="${p1RecentLosses}">0</span>
                            <span class="text-slate-500">L</span>
                        </div>
                    </div>
                </div>

                <!-- Player 2 Card -->
                <div class="bg-gradient-to-br from-orange-900/30 to-slate-800 border border-orange-800/50 rounded-xl p-6">
                    <div class="flex items-center gap-4 mb-4">
                        <div class="flex-shrink-0">
                            <img th:if="${player2Image}" th:src="${player2Image}" 
                                 alt="Player 2" class="w-20 h-20 rounded-full object-cover border-3 border-orange-400"
                                 onerror="this.style.display='none'">
                            <div th:unless="${player2Image}" 
                                 class="w-20 h-20 rounded-full bg-slate-700 flex items-center justify-center text-3xl border-3 border-orange-400">
                                üë§
                            </div>
                        </div>
                        <div>
                            <a th:href="@{/ui/player/{key}(key=${player2.playerKey})}" 
                               class="text-2xl font-bold text-orange-400 hover:text-orange-300 transition-colors"
                               th:text="${player2.playerName}">Player 2</a>
                            <div class="text-slate-400">
                                <span th:text="${player2.country}">Country</span>
                                <span th:if="${player2.currentRank}" class="ml-2">‚Ä¢ Rank #<span th:text="${player2.currentRank}">1</span></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Form -->
                    <div class="border-t border-slate-700 pt-4">
                        <div class="text-sm text-slate-400 mb-2">Recent Form (Last 10)</div>
                        <div class="flex items-center gap-2">
                            <span class="text-emerald-400 font-bold" th:text="${p2RecentWins}">0</span>
                            <span class="text-slate-500">W</span>
                            <span class="text-slate-600 mx-1">-</span>
                            <span class="text-red-400 font-bold" th:text="${p2RecentLosses}">0</span>
                            <span class="text-slate-500">L</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Head-to-Head Summary -->
            <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-8 mb-8">
                <h3 class="text-xl font-bold text-center mb-6">‚öîÔ∏è Head-to-Head Record</h3>
                
                <div class="flex items-center justify-center gap-8 mb-6">
                    <!-- Player 1 H2H -->
                    <div class="text-center">
                        <div class="text-5xl font-bold text-blue-400" th:text="${p1H2HWins}">0</div>
                        <div class="text-slate-400 text-sm mt-1" th:text="${player1.playerName}">Player 1</div>
                    </div>
                    
                    <!-- Separator -->
                    <div class="text-4xl text-slate-600">-</div>
                    
                    <!-- Player 2 H2H -->
                    <div class="text-center">
                        <div class="text-5xl font-bold text-orange-400" th:text="${p2H2HWins}">0</div>
                        <div class="text-slate-400 text-sm mt-1" th:text="${player2.playerName}">Player 2</div>
                    </div>
                </div>
                
                <!-- H2H Progress Bar -->
                <div th:if="${p1H2HWins + p2H2HWins > 0}" class="max-w-md mx-auto">
                    <div class="h-3 bg-slate-700 rounded-full overflow-hidden flex">
                        <div class="bg-blue-500 transition-all" 
                             th:style="'width: ' + ${(p1H2HWins * 100) / (p1H2HWins + p2H2HWins)} + '%'"></div>
                        <div class="bg-orange-500 transition-all" 
                             th:style="'width: ' + ${(p2H2HWins * 100) / (p1H2HWins + p2H2HWins)} + '%'"></div>
                    </div>
                </div>
                
                <div th:if="${p1H2HWins + p2H2HWins == 0}" class="text-center text-slate-500">
                    No previous meetings found
                </div>
            </div>

            <!-- Surface Statistics Comparison -->
            <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6 mb-8">
                <h3 class="text-lg font-bold mb-4">üèüÔ∏è Surface Statistics (Current Season)</h3>
                
                <div class="grid md:grid-cols-3 gap-4">
                    <!-- Hard -->
                    <div class="bg-slate-800/50 rounded-lg p-4">
                        <div class="text-slate-400 text-sm mb-3 flex items-center gap-2">
                            <span class="w-3 h-3 bg-blue-500 rounded-full"></span>
                            Hard Court
                        </div>
                        <div class="flex justify-between items-center">
                            <div class="text-center">
                                <span class="text-blue-400 font-bold" th:text="${p1SurfaceStats['Hard'][0]}">0</span>
                                <span class="text-slate-500">-</span>
                                <span class="text-slate-400" th:text="${p1SurfaceStats['Hard'][1]}">0</span>
                            </div>
                            <div class="text-slate-600">vs</div>
                            <div class="text-center">
                                <span class="text-orange-400 font-bold" th:text="${p2SurfaceStats['Hard'][0]}">0</span>
                                <span class="text-slate-500">-</span>
                                <span class="text-slate-400" th:text="${p2SurfaceStats['Hard'][1]}">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Clay -->
                    <div class="bg-slate-800/50 rounded-lg p-4">
                        <div class="text-slate-400 text-sm mb-3 flex items-center gap-2">
                            <span class="w-3 h-3 bg-orange-600 rounded-full"></span>
                            Clay Court
                        </div>
                        <div class="flex justify-between items-center">
                            <div class="text-center">
                                <span class="text-blue-400 font-bold" th:text="${p1SurfaceStats['Clay'][0]}">0</span>
                                <span class="text-slate-500">-</span>
                                <span class="text-slate-400" th:text="${p1SurfaceStats['Clay'][1]}">0</span>
                            </div>
                            <div class="text-slate-600">vs</div>
                            <div class="text-center">
                                <span class="text-orange-400 font-bold" th:text="${p2SurfaceStats['Clay'][0]}">0</span>
                                <span class="text-slate-500">-</span>
                                <span class="text-slate-400" th:text="${p2SurfaceStats['Clay'][1]}">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Grass -->
                    <div class="bg-slate-800/50 rounded-lg p-4">
                        <div class="text-slate-400 text-sm mb-3 flex items-center gap-2">
                            <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                            Grass Court
                        </div>
                        <div class="flex justify-between items-center">
                            <div class="text-center">
                                <span class="text-blue-400 font-bold" th:text="${p1SurfaceStats['Grass'][0]}">0</span>
                                <span class="text-slate-500">-</span>
                                <span class="text-slate-400" th:text="${p1SurfaceStats['Grass'][1]}">0</span>
                            </div>
                            <div class="text-slate-600">vs</div>
                            <div class="text-center">
                                <span class="text-orange-400 font-bold" th:text="${p2SurfaceStats['Grass'][0]}">0</span>
                                <span class="text-slate-500">-</span>
                                <span class="text-slate-400" th:text="${p2SurfaceStats['Grass'][1]}">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- H2H Match History -->
            <div th:if="${!h2hMatches.isEmpty()}" class="bg-slate-900/50 border border-slate-800 rounded-xl p-6 mb-8">
                <h3 class="text-lg font-bold mb-4">üìú Head-to-Head Match History</h3>
                
                <div class="space-y-3">
                    <a th:each="match : ${h2hMatches}" 
                       th:href="@{/ui/match/{id}(id=${match.eventKey})}"
                       class="flex items-center justify-between p-4 bg-slate-800/50 rounded-lg hover:bg-slate-800 transition-colors group">
                        <div class="flex items-center gap-4">
                            <span class="text-slate-400 mono text-sm w-24" th:text="${match.eventDate}">Date</span>
                            <div class="flex items-center gap-2">
                                <span th:class="${#strings.equals(match.winner, player1Key) || (#strings.equals(match.winner, 'First Player') && #strings.equals(match.firstPlayerKey, player1Key)) || (#strings.equals(match.winner, 'Second Player') && #strings.equals(match.secondPlayerKey, player1Key))} ? 'text-blue-400 font-semibold' : 'text-slate-400'"
                                      th:text="${player1.playerName}">Player 1</span>
                                <span class="text-slate-600">vs</span>
                                <span th:class="${#strings.equals(match.winner, player2Key) || (#strings.equals(match.winner, 'First Player') && #strings.equals(match.firstPlayerKey, player2Key)) || (#strings.equals(match.winner, 'Second Player') && #strings.equals(match.secondPlayerKey, player2Key))} ? 'text-orange-400 font-semibold' : 'text-slate-400'"
                                      th:text="${player2.playerName}">Player 2</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-4">
                            <span class="mono" th:text="${match.score ?: '-'}">Score</span>
                            <span class="text-slate-600 group-hover:text-emerald-400 transition-colors">‚Üí</span>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Recent Matches Side by Side -->
            <div class="grid md:grid-cols-2 gap-6">
                <!-- Player 1 Recent -->
                <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                    <h3 class="text-lg font-bold mb-4 text-blue-400" th:text="${player1.playerName + '''s Recent Matches'}">Player 1's Recent</h3>
                    
                    <div th:if="${p1RecentMatches.isEmpty()}" class="text-slate-500 text-center py-4">
                        No recent matches found
                    </div>
                    
                    <div th:unless="${p1RecentMatches.isEmpty()}" class="space-y-2">
                        <a th:each="match : ${p1RecentMatches}"
                           th:href="@{/ui/match/{id}(id=${match.eventKey})}"
                           class="flex items-center gap-3 p-3 bg-slate-800/50 rounded-lg hover:bg-slate-800 transition-colors text-sm">
                            <!-- W/L indicator -->
                            <span th:if="${#strings.equals(match.winner, player1Key) || (#strings.equals(match.winner, 'First Player') && #strings.equals(match.firstPlayerKey, player1Key)) || (#strings.equals(match.winner, 'Second Player') && #strings.equals(match.secondPlayerKey, player1Key))}" 
                                  class="w-6 h-6 bg-emerald-500 rounded flex items-center justify-center text-xs font-bold text-white flex-shrink-0">W</span>
                            <span th:unless="${#strings.equals(match.winner, player1Key) || (#strings.equals(match.winner, 'First Player') && #strings.equals(match.firstPlayerKey, player1Key)) || (#strings.equals(match.winner, 'Second Player') && #strings.equals(match.secondPlayerKey, player1Key))}" 
                                  class="w-6 h-6 bg-red-500 rounded flex items-center justify-center text-xs font-bold text-white flex-shrink-0">L</span>
                            
                            <span class="text-slate-400 mono text-xs w-20 flex-shrink-0" th:text="${match.eventDate}">Date</span>
                            <span class="text-white truncate">
                                vs <span th:text="${#strings.equals(match.firstPlayerKey, player1Key) ? match.secondPlayerName : match.firstPlayerName}">Opponent</span>
                            </span>
                            <span class="text-slate-500 mono text-xs ml-auto flex-shrink-0" th:text="${match.score ?: '-'}">Score</span>
                        </a>
                    </div>
                </div>

                <!-- Player 2 Recent -->
                <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                    <h3 class="text-lg font-bold mb-4 text-orange-400" th:text="${player2.playerName + '''s Recent Matches'}">Player 2's Recent</h3>
                    
                    <div th:if="${p2RecentMatches.isEmpty()}" class="text-slate-500 text-center py-4">
                        No recent matches found
                    </div>
                    
                    <div th:unless="${p2RecentMatches.isEmpty()}" class="space-y-2">
                        <a th:each="match : ${p2RecentMatches}"
                           th:href="@{/ui/match/{id}(id=${match.eventKey})}"
                           class="flex items-center gap-3 p-3 bg-slate-800/50 rounded-lg hover:bg-slate-800 transition-colors text-sm">
                            <!-- W/L indicator -->
                            <span th:if="${#strings.equals(match.winner, player2Key) || (#strings.equals(match.winner, 'First Player') && #strings.equals(match.firstPlayerKey, player2Key)) || (#strings.equals(match.winner, 'Second Player') && #strings.equals(match.secondPlayerKey, player2Key))}" 
                                  class="w-6 h-6 bg-emerald-500 rounded flex items-center justify-center text-xs font-bold text-white flex-shrink-0">W</span>
                            <span th:unless="${#strings.equals(match.winner, player2Key) || (#strings.equals(match.winner, 'First Player') && #strings.equals(match.firstPlayerKey, player2Key)) || (#strings.equals(match.winner, 'Second Player') && #strings.equals(match.secondPlayerKey, player2Key))}" 
                                  class="w-6 h-6 bg-red-500 rounded flex items-center justify-center text-xs font-bold text-white flex-shrink-0">L</span>
                            
                            <span class="text-slate-400 mono text-xs w-20 flex-shrink-0" th:text="${match.eventDate}">Date</span>
                            <span class="text-white truncate">
                                vs <span th:text="${#strings.equals(match.firstPlayerKey, player2Key) ? match.secondPlayerName : match.firstPlayerName}">Opponent</span>
                            </span>
                            <span class="text-slate-500 mono text-xs ml-auto flex-shrink-0" th:text="${match.score ?: '-'}">Score</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- No players selected state -->
        <div th:unless="${player1 != null && player2 != null}" class="text-center py-16">
            <div class="text-6xl mb-4">‚öîÔ∏è</div>
            <h3 class="text-xl text-slate-400 mb-2">Select Two Players to Compare</h3>
            <p class="text-slate-500">Use the dropdowns above to pick two players for head-to-head comparison</p>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-slate-800 mt-12 py-6 text-center text-slate-600 text-sm">
        Tennis Data Adapter ‚Ä¢ Powered by API Tennis
    </footer>
</body>
</html>

